:root {
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  color: #f8f9fa;
  background-color: #0b0b0b;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  background: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.05), transparent 60%), #050505;
  color: inherit;
}

.world-shell {
  min-height: 100vh;
  padding: clamp(1rem, 2vw, 2rem);
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.world-header {
  border: 1px solid #1b1b1b;
  border-radius: 18px;
  padding: clamp(1rem, 3vw, 1.5rem);
  background: linear-gradient(135deg, rgba(123, 120, 255, 0.12), rgba(5, 5, 5, 0.95));
}

.world-header__actions {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.75rem;
  justify-content: space-between;
}

.world-role-pill {
  border-radius: 999px;
  border: 1px solid #343434;
  padding: 0.35rem 0.85rem;
  font-size: 0.85rem;
  background: rgba(255, 255, 255, 0.05);
}

.world-header__blurb {
  margin-top: 0.85rem;
  max-width: 640px;
}

.world-events-panel {
  border: 1px solid #1c1c1c;
  border-radius: 16px;
  background: rgba(8, 8, 8, 0.85);
  padding: clamp(1rem, 2vw, 1.5rem);
}

.world-events-panel__body {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.we-card {
  border: 1px solid #2a2a2a;
  border-radius: 12px;
  padding: 0.85rem 1rem;
  background: rgba(12, 12, 12, 0.95);
  transition: border-color 180ms ease, box-shadow 180ms ease;
  cursor: pointer;
}

.we-card.selected {
  border-color: #7b78ff;
  box-shadow: 0 0 12px rgba(123, 120, 255, 0.25);
}

.we-card-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
}

.we-desc {
  color: #b6bac5;
  font-size: 0.9rem;
}

.we-effects {
  list-style: none;
  padding-left: 0;
  margin: 0.5rem 0 0;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.we-checkbox input {
  pointer-events: none;
}

/* Prevent visual overflow of the viewport on mobile devices */
@media (max-width: 840px) {
  html, body, #root { max-width: 100vw; overflow-x: hidden; }
}

/* Pager behavior: horizontal swiping via .pager-inner remains enabled on mobile; ensure page content still fits */

button {
  border-radius: 6px;
  border: 1px solid #2a2a2a;
  background: #151515;
  color: inherit;
  padding: 0.4rem 0.75rem;
  cursor: pointer;
}

button:hover {
  border-color: #575cff;
}

main {
  padding-bottom: 3rem;
}

.app-shell {
  width: min(100%, 1100px);
  margin: 0 auto;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.ops-toolbar,
.ops-save {
  display: flex;
  gap: 8px;
  align-items: center;
}

.ops-toolbar {
  flex-wrap: wrap;
  width: 100%;
  justify-content: flex-start;
  margin-top: 8px;
}

.ops-save {
  flex-wrap: wrap;
  flex: 1 1 320px;
  margin-left: 0;
  width: 100%;
}

.ops-save input {
  flex: 1 1 180px;
  min-width: 0;
}

/* Pager and mobile-forward layout */
.pager {
  width: 100%;
  overflow: hidden;
  position: relative; /* container for absolutely-positioned pages on mobile */
  transition: height 200ms ease;
}
.pager { touch-action: pan-y; }
.pager-inner {
  /* per-page transforms and absolute positioning control exclusive visible page semantics. Use block container so absolute pages layer correctly. */
  display: block !important;
  width: auto !important;
  transition: transform 320ms cubic-bezier(.2,.8,.2,1) !important;
}
.pager .pager-inner { display: flex !important; flex-direction: row !important; flex-wrap: nowrap !important; }
.pager-inner { cursor: grab; }
.pager-inner:active { cursor: grabbing; }
.page {
  min-width: 100%;
  padding: 1rem;
}
.pager-nav {
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:center;
  margin: 0.5rem 0 1rem 0;
  z-index: 10000; /* ensure page nav sits above absolute pages so clicks reach it */
  position: relative; /* provide stacking context so z-index is honored on desktop */
}
.pager-dot {
  width:10px;height:10px;border-radius:50%;background:#2a2a2a;opacity:0.5;
}
.pager-dot.active{background:#7b78ff;opacity:1;transform:scale(1.35);transition:transform 220ms}
.pager-dot{transition:transform 220ms, opacity 180ms}

.pager-item{display:flex;flex-direction:column;align-items:center;gap:6px;min-width:48px}
.pager-label{font-size:0.8rem;color:#b6bac5}
.pager-item[aria-current='true'] .pager-label{color:#7b78ff;font-weight:600}

/* Shared card grids */
.card-grid {
  display: grid;
  gap: 12px;
}

.card-grid.base-card-grid {
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 10px;
}

.card-grid.mod-card-grid {
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
}

/* Card-like containers */
.card {
  border:1px solid #222;
  border-radius:12px;
  padding:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.1));
  min-width: 0; /* allow grid children to shrink on mobile */
  word-break: break-word;
  overflow-wrap: anywhere;
  width: 100%;
  box-sizing: border-box;
  overflow-x: hidden; /* ensure card content cannot overflow horizontally */
  max-width: 100%;
}

.card * {
  min-width: 0; /* prevent child content (dd, dt, divs) from causing overflow */
}

/* Ensure the header row of cards allows the left content to shrink and the right controls to remain anchored inside the border */
.card > div > div:first-child { min-width:0; flex: 1 1 auto; }
.card > div > div:last-child { flex: 0 0 auto; min-width:0; }
/* Prevent the left header content from growing too large and pushing action buttons beyond the right edge */
.card > div > div:first-child { max-width: calc(100% - 120px); }
@media (max-width: 520px) {
  .card > div > div:first-child { max-width: calc(100% - 96px); }
}
/* Ensure long header line wraps inside the left column to avoid pushing right controls out */
.card > div > div:first-child { overflow-wrap: anywhere; word-break: break-word; white-space: normal; }

/* Base-card-specific header adjustments to ensure control buttons remain inside the card border */
.card-grid.base-card-grid .card > div { overflow: hidden; }
.card-grid.base-card-grid .card > div > div:last-child { display: flex; align-items: center; gap: 6px; flex: 0 0 auto; }
.card-grid.base-card-grid .card > div > div:last-child button { min-width: 36px; width: 36px; height: 36px; padding: 0; box-sizing: border-box; }
.card-grid.base-card-grid .card > div > div:last-child button svg, .card-grid.base-card-grid .card > div > div:last-child button span { display:block; width:100%; height:100%; }

/* Class-based sizing and padding rules for base and mod cards */
.card.base-card { padding: 12px 18px; border-radius: 10px; }
.card.mod-card { padding: 12px; border-radius: 10px; }
.card.small-card { padding: 8px; border-radius: 10px; }

/* Base-card header override for explicit scoping */
.card.base-card > div { overflow: hidden; }
.card.base-card > div > div:first-child { min-width: 0; flex: 1 1 auto; }
.card.base-card > div > div:last-child { flex: 0 0 auto; min-width: 0; margin-left: 12px; }

/* Debug class overlays element bounds: only visible when ?debug=overflow is set */
.debug-overflow * {
  outline: 1px dashed rgba(255,64,64,0.2);
}
.debug-overflow .card { outline: 2px solid rgba(255, 64, 64, 0.25); }

.card dl dt,
.card dl dd {
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: normal;
}

/* Details grid class; default layout uses two columns (label/value) */
.card-details { display: grid; grid-template-columns: minmax(80px, 30%) 1fr; column-gap: 8px; row-gap: 4px; }
.card-details dt, .card-details dd { margin: 0; }
@media (max-width: 1400px) {
  .card-details { grid-template-columns: 1fr; }
}

/* More aggressive stacking on phone-sized viewports to avoid label/value wide columns */
@media (max-width: 1080px) {
  .card-details { grid-template-columns: 1fr; }
}

/* Label column sizing: give dt a max width to prevent large left column from forcing horizontal layout */
.card dl dt { max-width: 30%; min-width: 80px; }
.card dl dd { max-width: 70%; }

/* Tighter label widths for base cards to reduce content wrap */
.card-grid.base-card-grid .card .card-details dt { max-width: 18%; min-width: 60px; }
.card-grid.base-card-grid .card .card-details dd { max-width: 82%; }

/* Ensure images and svgs do not overflow cards */
.card img, .card svg { max-width: 100%; height: auto; display: block; }

/* Mobile first adjustments */
@media (max-width: 840px) {
  .app-shell {
    width: min(100%, 520px);
    padding: 0.75rem 0.85rem 6.5rem;
  }
  .card { padding:10px; }
  button { padding: 0.5rem 0.85rem; }
  main { padding: 0.5rem; }
  .card-grid { grid-template-columns: minmax(0, 1fr) !important; }
  .card-grid.base-card-grid .card { max-width: calc(100% - 16px); }
  .ops-save button,
  .ops-toolbar button {
    flex: 1 1 140px;
  }
  /* Sticky pager: mobile-first bottom nav that stays visible while interacting */
  .pager-nav {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1000;
    background: linear-gradient(180deg, rgba(0,0,0,0.85), rgba(0,0,0,0.95));
    padding: 10px 12px;
    margin: 0;
    box-shadow: 0 -2px 8px rgba(0,0,0,0.5);
  }
  /* Ensure page content doesn't get covered by fixed pager */
  main { padding-bottom: 6.5rem; }
  /* Prevent any accidental horizontal overflow in page content */
  .page, .app-shell { overflow-x: hidden; }
  .page * { min-width: 0; max-width: 100%; }
}

/* Narrow phone-specific adjustments */
@media (max-width: 520px) {
  /* Always single column */
  .card-grid.base-card-grid, .card-grid.mod-card-grid { grid-template-columns: 1fr !important; }
  .card { padding: 10px 12px; }
  .app-shell { width: min(100%, 480px); }
}

/* More aggressive single-column enforcement for phones and larger phones in landscape */
@media (max-width: 980px) {
  .card-grid.base-card-grid, .card-grid.mod-card-grid { grid-template-columns: 1fr !important; }
  .app-shell { width: 100%; padding: 0.5rem; }
}

/* Stack labels/values into rows if the screen is narrow */
@media (max-width: 1400px) {
  .card dl { grid-template-columns: 1fr; grid-auto-flow: row; }
  .card dl dt { grid-column: 1; margin-top: 6px; }
  .card dl dd { grid-column: 1; margin-left: 0; }
  .card p, .card div, .card span { word-break: break-word; overflow-wrap: anywhere; }
  .card * { max-width: 100%; }
  .card-grid > * { width: 100%; min-width: 0; max-width: 100%; }
  .card button { min-width: 0; }
}

/* defensive mobile layout to guarantee no bleed on any phone width */
@media (max-width: 1400px) {
  html, body, #root, .app-shell, .page { max-width: 100vw !important; overflow-x: hidden !important; }
  .pager { overflow-x: hidden !important; }
  /* ensure page content clamps to viewport for any transform based pager */
  .page { max-width: calc(100vw - env(safe-area-inset-left) - env(safe-area-inset-right)); }
  /* Force single column for cards */
  .card-grid.base-card-grid, .card-grid.mod-card-grid { grid-template-columns: 1fr !important; }
  /* shrink label column more on medium widths */
  .card dl dt { max-width: 20%; min-width: 56px; }
  .card dl dd { max-width: 80%; }
}

/* Increase page gutters for mobile to avoid edge glancing */
@media (max-width: 1080px) {
  .page { padding-left: clamp(16px, 4vw, 24px) !important; padding-right: clamp(16px, 4vw, 24px) !important; }
  .app-shell { padding-left: clamp(12px, 3vw, 20px) !important; padding-right: clamp(12px, 3vw, 20px) !important; }
  /* ensure card grid has internal gutters */
  .card-grid.base-card-grid { padding-left: 12px; padding-right: 12px; }
}

/* Target 1080x1920 and smaller devices (common Full HD mobile) */
@media (max-width: 1080px) {
  .app-shell { width: 100%; max-width: 1080px; padding: 0.75rem; }
  .card-grid.base-card-grid, .card-grid.mod-card-grid { grid-template-columns: 1fr !important; }
  .card { width: 100%; padding: 10px 12px; }
  h1 { font-size: clamp(1.6rem, 4vw, 2.4rem); }
  h2 { font-size: clamp(1.2rem, 3.5vw, 1.6rem); }
  .card dl dt { max-width: 28%; min-width: 70px; }
  .card dl dd { max-width: 72%; }
  .card p, .card dl, .card div { font-size: clamp(0.8rem, 2.4vw, 1rem); }
  .page, .app-shell { overflow-x: hidden; }
  .card { box-sizing: border-box; }
}

/* Add a little more right padding to keep action buttons comfortably inside card bounds */
@media (max-width: 1080px) {
  .card { padding-right: clamp(12px, 4vw, 20px) !important; }
  /* More aggressive right padding for base cards on mobile; include safe-area insets */
  .card.base-card { padding-inline-end: calc(clamp(18px, 6vw, 28px) + env(safe-area-inset-right, 0px)) !important; }
}

/* Extra padding on very narrow devices to ensure visual padding even when safe-area is limited */
@media (max-width: 420px) {
  .card.base-card { padding-inline-end: calc(22px + env(safe-area-inset-right, 0px)) !important; }
}

/* PWA (standalone) display mode often has different viewports and no browser chrome; add extra padding */
@media (display-mode: standalone) {
  .card.base-card { padding-inline-end: calc(22px + env(safe-area-inset-right, 0px)) !important; }
}

@media (max-width: 420px) and (display-mode: standalone) {
  .card.base-card { padding-inline-end: calc(28px + env(safe-area-inset-right, 0px)) !important; }
}

/* Ensure base card horizontal padding prevents edge touching on various phones */
@media (max-width: 1080px) {
  .card-grid.base-card-grid .card {
    padding-left: clamp(12px, 4vw, 18px) !important;
    padding-right: clamp(12px, 4vw, 18px) !important;
  }
  /* Force label column restraint for base cards (override broader rules) */
  .card-grid.base-card-grid .card .card-details dt { max-width: 18% !important; min-width: 56px; }
  .card-grid.base-card-grid .card .card-details dd { max-width: 82% !important; }
}

/* Keep transform-based pager behavior: prefer per-page transforms and explicit visibility so only one page is visible at once.
   This is applied globally to avoid any breakpoints unexpectedly showing multiple pages at once. 
   Desktop and mobile will both respect per-page transforms and aria-hidden state.
*/
.pager-inner { display: block !important; width: auto !important; }
.pager-inner .page { min-width: 100% !important; width: 100% !important; }

/* On mobile, if display:flex is being overridden for any reason, fall back to absolute positioning per page
   so we can still guarantee single-page visibility via transform. This avoids relying on pager-inner's flex
   behavior if a higher-priority stylesheet or runtime script changes it. We only enable this on smaller viewports
   to keep desktop experience consistent. */
/* Apply absolute page positioning and aria-hidden visibility globally so exclusivity is consistent across viewports */
.pager { /* ensure we can size to active page */ }
.pager .page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  transition: transform 320ms cubic-bezier(.2,.8,.2,1), opacity 220ms ease;
  will-change: transform, opacity;
}
.pager .page[data-hidden='true'], .pager .page[aria-hidden='true'] {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.pager .page[data-hidden='false'], .pager .page[aria-hidden='false'] {
  pointer-events: auto;
  opacity: 1;
  visibility: visible;
}

/* Fallback for very small devices where Safari visual viewport might cause overflow: ensure card content fits by shrinking font and spacing */
@media (max-width: 400px) {
  .card { padding: 8px; }
  .card h3, .card h2, .card h1 { font-size: clamp(1rem, 4vw, 1.2rem) !important; }
  .card dl { font-size: 0.75rem; }
}

/* Reduce heading and large numeric font sizes on narrower screens to prevent overflow */
@media (max-width: 600px) {
  h1, h2, h3 { font-size: clamp(1rem, 3.5vw, 1.6rem); }
  .card .muted, .card p, .card dl { font-size: clamp(0.75rem, 2.6vw, 0.95rem); }
}

code {
  font-family: 'JetBrains Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
}
